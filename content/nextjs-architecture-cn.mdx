---
title: 'ğŸª Next.js å…¨æ ˆç ”å‘æ¶æ„æŒ‡å—'
publishedAt: '2025-05-13'
summary: "Arno's Architecture Design for complex next.js driven web application."
tags: ['Frontend', 'Backend', 'Fullstack', 'cn']
---

> Arno åœ¨ä½¿ç”¨ next.js ä¸ºé˜¿é‡Œå·´å·´çš„é’‰é’‰(DingTalk)å’Œå…¶ä»–å¤§å‹é¡¹ç›®æä¾›ä»–æœ€å¥½çš„æœ€ä½³å®è·µ(BP)ã€‚

è¯¥æ–‡ç« ä½¿ç”¨ GPT ç¿»è¯‘è‡ªåŸæ–‡ï¼š[Next.js Full Stack App Architecture Guide](https://arno.surfacew.com/posts/en/nextjs-architecture)

## Server

### é€šç”¨ API å’Œæ¶æ„é£æ ¼

- **è‡ªé€‚åº”æ¶æ„è®¾è®¡** - æ¶æ„åº”éšé¡¹ç›®ç”Ÿå‘½å‘¨æœŸçš„ä¸åŒé˜¶æ®µè€Œæ¼”åŒ–ã€‚ä¸è¦ä¸ºæ¯ä¸ªé¡¹ç›®é»˜è®¤ä½¿ç”¨å¤æ‚çš„æ¨¡å¼ï¼Œ## å‚è€ƒèµ„æ–™

æˆ‘çš„ç›¸å…³æ–‡ç« ï¼š

- [é«˜æ•ˆå…¨æ ˆå¼€å‘](https://arno.surfacew.com/posts/en/effective-fullstack-dev)
- [AI é©±åŠ¨çš„å‰ç«¯å¼€å‘](https://arno.surfacew.com/posts/en/ai-driven-front-end)
- [Cursor æœ€ä½³å®è·µ](/posts/en/cursor.bp)

### å…³äºæœ¬æ–‡çš„æ³¨é‡Š

- 2024-02-02ï¼šåˆå§‹ç‰ˆæœ¬
- 2024-03-12ï¼šä¿®å¤é”™è¯¯å¹¶ä¸ºæŸäº›ä¸»é¢˜æ·»åŠ æ›´å¤šç»†èŠ‚ï¼Œæ·»åŠ ä¸ `db` ç›¸å…³çš„ä¸»é¢˜æŒ‡å—
- 2024-03-29ï¼šå¢åŠ ä¸€äº›å…³äºç»„ä»¶ç›®å½•çš„ç»„ç»‡è§„èŒƒå’Œå‘½åæ–¹å¼
- 2024-10-21ï¼šå¢åŠ äº†ä¸€äº› server-action çš„æœ€ä½³å®è·µï¼ŒåŒæ—¶å¢åŠ äº†ä¸€äº›å…³äºé”™è¯¯å¤„ç†çš„æœ€ä½³å®è·µ
- 2025-05-13ï¼šä¿æŒä¸æœ€æ–° next.js ç‰ˆæœ¬åŠç›¸å…³æŠ€æœ¯çŸ¥è¯†æ›´æ–°-servicesï¼‰ï¼Œå°¤å…¶æ˜¯å¯¹äºå°å‹é¡¹ç›®æˆ– MVPã€‚ç›¸åï¼Œåº”é‡‡ç”¨è¿›åŒ–çš„æ–¹æ³•ï¼Œè®©æ¶æ„é€‚åº”ä¸æ–­å˜åŒ–çš„éœ€æ±‚å’Œè§„æ¨¡ã€‚

- **æˆ˜ç•¥æ€§ API è®¾è®¡** - å……åˆ†åˆ©ç”¨ [_RESTful åŸåˆ™_](https://learn.microsoft.com/en-us/azure/architecture/best-practices/api-design) å¹¶éµå¾ªä¸¥æ ¼çš„è®¾è®¡æŒ‡å—ã€‚åœ¨é€‚å½“çš„æƒ…å†µä¸‹ï¼Œè€ƒè™‘ä½¿ç”¨ RPC æ¡†æ¶å¦‚ `GraphQL` æˆ– `gRPC`ã€‚åœ¨é›†æˆå‰è°¨æ…è¯„ä¼°é€šä¿¡åè®®â€”â€”é™¤éç‰¹å®šéœ€æ±‚è¯æ˜å…¶å¿…è¦æ€§ï¼Œå¦åˆ™é¿å…ä¸å¿…è¦çš„å¤æ‚æ€§ã€‚

- **æ— çŠ¶æ€å’Œæ— æœåŠ¡å™¨ä¼˜å…ˆ** - é€šè¿‡ä¼˜å…ˆè€ƒè™‘æ— çŠ¶æ€æ¶æ„å’Œæ— æœåŠ¡å™¨éƒ¨ç½²æ¨¡å‹ï¼Œè®¾è®¡æœ¬è´¨ä¸Šå¯æ‰©å±•å’Œæ˜“äºç®¡ç†çš„æœåŠ¡ã€‚åƒ `Vercel` è¿™æ ·çš„å¹³å°ä¸º Next.js åº”ç”¨æä¾›äº†ä¼˜åŒ–çš„æ— æœåŠ¡å™¨ç¯å¢ƒã€‚å…¶ä»–éƒ¨ç½²é€‰é¡¹åŒ…æ‹¬ `Aliyun` æˆ– `CloudFlare EdgeWorker` æœåŠ¡ã€‚

- **å¥å£®çš„ API ç®¡ç†** - å®æ–½ç‰ˆæœ¬æ§åˆ¶ï¼ˆå¦‚ `/api/v1/*`ï¼‰ä»¥ç»´æŠ¤å…¬å…±å’Œå†…éƒ¨ API çš„å‘åå…¼å®¹æ€§ã€‚éµå¾ªæ ‡å‡†è§„èŒƒå¦‚ [`OpenAPI`](https://swagger.io/specification/) æˆ– `Swagger` ä»¥ç¡®ä¿å…¨é¢çš„æ–‡æ¡£å’Œå¯ç”¨æ€§ã€‚éšç€é¡¹ç›®å¤æ‚æ€§å¢åŠ ï¼Œæ ¹æ®æ‚¨çš„ç‰¹å®šç”¨ä¾‹é€‰æ‹©é€‚å½“çš„æ–¹æ³•æ¥ç®¡ç†è¿™ç§å¤æ‚æ€§ã€‚

- **å……åˆ†åˆ©ç”¨ Next.js å…¨æ ˆèƒ½åŠ›** - åˆ©ç”¨ Next.js çš„å…¨é¢å…¨æ ˆåŠŸèƒ½å¿«é€Ÿå¼€å‘å’ŒéªŒè¯æ¦‚å¿µã€‚å®æ–½åˆ†å±‚æ¶æ„æ–¹æ³•ï¼Œéšç€å¤æ‚æ€§å¢é•¿å¼•å…¥åˆ†ç¦»ï¼Œä»¥ç»´æŒå¯ç»´æŠ¤æ€§å’Œå¯æ‰©å±•æ€§ã€‚

ä¸‹é¢æˆ‘ä»¬å±•ç¤ºäº† next.js å…¨æ ˆåº”ç”¨çš„åˆ†å±‚æ¶æ„è®¾è®¡ï¼š

```ascii
+-----------------------------------------------------------------------------------------------+
|                                       å®¢æˆ·ç«¯                                                   |
+-----------------------------------------------------------------------------------------------+
                |                          |                           |
                | é¡µé¢è¯·æ±‚                 | APIè¯·æ±‚                   | æœåŠ¡ç«¯åŠ¨ä½œ
                â†“                          â†“                           â†“
+-----------------------------------------------------------------------------------------------+
|                                    æ§åˆ¶å™¨å±‚                                                   |
|                                                                                               |
|  +-----------------+    +------------------+    +---------------------+                       |
|  |    é¡µé¢è·¯ç”±      |    |     APIè·¯ç”±      |    |     æœåŠ¡ç«¯åŠ¨ä½œ      |                       |
|  +-----------------+    +------------------+    +---------------------+                       |
|         |                       |                         |                                   |
|         +--------------------------------------------------                                   |
|                                  |                                                            |
+-----------------------------------------------------------------------------------------------+
                                   | è°ƒç”¨
                                   â†“
+-----------------------------------------------------------------------------------------------+
|                                    æœåŠ¡å±‚                                                     |
|                                                                                               |
|  +------------------+    +------------------+    +------------------+                         |
|  |   é¢†åŸŸæœåŠ¡ A      |    |   é¢†åŸŸæœåŠ¡ B      |    |   é¢†åŸŸæœåŠ¡ C      |                         |
|  +------------------+    +------------------+    +------------------+                         |
|         |                       |                        |                                    |
|         +--------------------------------------------------                                   |
|                                  |                                                            |
+-----------------------------------------------------------------------------------------------+
                                   | ä½¿ç”¨
                                   â†“
+-----------------------------------------------------------------------------------------------+
|                                   ç®¡ç†å™¨å±‚                                                    |
|                                                                                               |
|  +------------------+    +------------------+    +------------------+                         |
|  |    ç®¡ç†å™¨ A       |    |    ç®¡ç†å™¨ B       |    |    ç®¡ç†å™¨ C       |                         |
|  +------------------+    +------------------+    +------------------+                         |
|                                                                                               |
+-----------------------------------------------------------------------------------------------+
                                   | è®¿é—®
                                   â†“
+-----------------------------------------------------------------------------------------------+
|                                æ•°æ®æŒä¹…åŒ–å±‚                                                   |
+-----------------------------------------------------------------------------------------------+
```

### Application å±‚ï¼ˆæ§åˆ¶å™¨ï¼‰

`æ§åˆ¶å™¨` / `è·¯ç”±`ï¼šå¯¹äº next.js æ¥è¯´ï¼Œapi-routes ä½¿ç”¨ `å‡½æ•°` ç¼–ç¨‹é£æ ¼ï¼Œå®ƒæ‰®æ¼”ç€ä¼ ç»Ÿåº”ç”¨å±‚çš„è§’è‰²ã€‚

- å¤„ç† Web å’Œåº”ç”¨å±‚çš„è¯·æ±‚ä¸å“åº”
- å¤„ç† Web æˆ–å…¶ä»–åè®®å“åº”çš„é”™è¯¯ï¼Œå¤„ç†é”™è¯¯ä»£ç å’Œé”™è¯¯æ¶ˆæ¯ -> å¯ä»¥å‚çœ‹ä¸‹é¢é”™è¯¯å¤„ç†æ¨¡å¼ç« èŠ‚çš„å†…å®¹
- è¿”å›"ç»Ÿä¸€"çš„å“åº”æˆ–æœåŠ¡ç»“æœå¯¹è±¡ï¼Œä¾›å®¢æˆ·ç«¯å¤„ç†
- æ§åˆ¶å™¨å¯ä»¥å†™åœ¨å…¨å±€ `ä¸­é—´ä»¶` å‡½æ•°ä¸­ï¼ˆç±»ä¼¼äº `koa`ï¼‰ï¼Œæˆ–ç”±é«˜é˜¶å‡½æ•°åŒ…è£…ä»¥å¤„ç†å…¬å…±é€»è¾‘ï¼ŒåŒ…æ‹¬ï¼š
  - å¯ç»„åˆçš„ `é¡µé¢è·¯ç”±`
  - å¯ç»„åˆçš„ `API è·¯ç”±` -> å¯ä»¥ç›´æ¥ä»æœåŠ¡å™¨åŠ¨ä½œè°ƒç”¨
  - å¯ç»„åˆçš„ `æœåŠ¡å™¨åŠ¨ä½œ`
- è¿™ä¸€å±‚æœ€å¥½ä¸åŒ…å«ä»»ä½•ä¸šåŠ¡é€»è¾‘

### Service å±‚

`Service`ï¼šç”¨é¢å‘å¯¹è±¡ï¼ˆOOï¼‰é£æ ¼å°è£…é¢†åŸŸæœåŠ¡å’Œç®¡ç†å™¨ï¼Œå¤„ç†ä¸šåŠ¡é€»è¾‘çš„æ¨¡å—

- å°è¯•ä½¿ç”¨**é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDomain Driven Designï¼‰**åŸåˆ™æä¾›é¢†åŸŸæœåŠ¡æ¥å¤„ç†ä¸šåŠ¡é€»è¾‘ã€æŒä¹…åŒ–æ•°æ®å’Œå…¶ä»–é¢†åŸŸç›¸å…³ä»»åŠ¡
- ä¸èƒ½æŠ›å‡ºé”™è¯¯ï¼Œå¹¶åº”åœ¨æœåŠ¡å±‚å¤„ç†é”™è¯¯
- è¿”å›"ç»Ÿä¸€"çš„å“åº”æˆ–æœåŠ¡ç»“æœå¯¹è±¡ï¼Œä¾›æ§åˆ¶å™¨å¤„ç†
- ä½¿ç”¨ Swagger æˆ–å…¶ä»–**æ­£å¼çš„ API è§„èŒƒ**ä¸ç¬¬ä¸‰æ–¹æœåŠ¡ä¾›åº”å•†é›†æˆï¼Œç¡®ä¿ä»£ç ä¸­çš„ API æ–‡æ¡£å®Œå–„ï¼Œå¹¶ä½¿ç”¨å·¥å…·ç”Ÿæˆè¿™äº› API å®¢æˆ·ç«¯ä»£ç 
- å°è¯•é’ˆå¯¹å„ç§ç±»ä¼¼æœåŠ¡çš„**é¢å‘æ¥å£**è®¾è®¡ï¼Œä¾‹å¦‚ `*.service.impl.ts`
- éµå®ˆ**é¢å‘å¯¹è±¡æœ€ä½³å®è·µï¼ˆOO BPï¼‰çš„è§„åˆ™**ï¼Œä¾‹å¦‚ SOLIDã€DRYã€KISS ç­‰
  - ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰é£æ ¼æ³¨å…¥ä¾èµ–ï¼Œæ„å»ºä¾èµ–æ³¨å…¥é©±åŠ¨çš„æœåŠ¡ä¾èµ–å’Œå®ä¾‹ç®¡ç†

```ts
// API Route
export const POST = composeAPIRoute([
  authUser,
  authBizLogic,
  async (req, res, ctx) => {}
])
// Page Server
export const getServerSideProps = composePageServer(
  function (params, ctx) {
    return <div>...</div>
  },
  [authUserInPage, authBizLogicInPage]
)
// Server Action
export const serverAction = composeServerAction([
  authUserAction,
  authBizLogicAction,
  async (req, res, ctx) => {}
])
```

> å…·ä½“çš„ Sample ä»£ç å¯ä»¥å‚çœ‹ï¼šhttps://github.com/SurfaceW/arno-packages/tree/main/server/next

- ä½¿ç”¨ Swagger æˆ–å…¶ä»–**æ­£å¼çš„ API è§„èŒƒ**ä¸ç¬¬ä¸‰æ–¹æœåŠ¡ä¾›åº”å•†é›†æˆï¼Œç¡®ä¿ä»£ç ä¸­çš„ API æ–‡æ¡£å®Œå–„ï¼Œå¹¶ä½¿ç”¨å·¥å…·ç”Ÿæˆè¿™äº› API å®¢æˆ·ç«¯ä»£ç 
- å°è¯•é’ˆå¯¹å„ç§ç±»ä¼¼æœåŠ¡çš„**é¢å‘æ¥å£**è®¾è®¡ï¼Œä¾‹å¦‚ `*.service.impl.ts`
- éµå®ˆ**é¢å‘å¯¹è±¡æœ€ä½³å®è·µï¼ˆOO BPï¼‰çš„è§„åˆ™**ï¼Œä¾‹å¦‚ SOLIDã€DRYã€KISS ç­‰ã€‚
  - ä½¿ç”¨ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰é£æ ¼æ³¨å…¥ä¾èµ–ï¼Œæ„å»ºä¾èµ–æ³¨å…¥é©±åŠ¨çš„æœåŠ¡ä¾èµ–å’Œå®ä¾‹ç®¡ç†

æœåŠ¡å±‚ä»£ç ç¤ºä¾‹ï¼š

```ts
export class ElaboratorService {
  private prisma = prismaClient

  constructor() {}

  // å¤„ç†é”™è¯¯å’Œç»Ÿä¸€å“åº”
  @WithServiceResult()
  async updateElaborator(data: Prisma.ElaboratorUpdateInput) {
    return (await this.prisma.elaborator.update({
      where: {
        id: data.id as bigint
      },
      data: data
    })) as any as ServiceResult<Elaborator>
  }
}
```

### Manager å±‚

`Manager`ï¼šä»¥é¢å‘å¯¹è±¡ï¼ˆOOï¼‰é£æ ¼ç®¡ç†å¯å¤ç”¨ä»£ç çš„ä¸šåŠ¡é€»è¾‘æ¨¡å—

- å¯ä»¥æŠ›å‡ºé”™è¯¯ï¼Œå¹¶åœ¨æœåŠ¡å±‚æˆ–æ›´é«˜å±‚å¤„ç†é”™è¯¯
- å¯ä»¥è¢«æœåŠ¡å±‚æˆ–å…¶ä»–ç®¡ç†å™¨å±‚ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥åœ¨æ§åˆ¶å™¨å±‚ï¼ˆæœåŠ¡å™¨åŠ¨ä½œã€è·¯ç”±ç­‰ï¼‰ä¸­ä½¿ç”¨ï¼Œä½†ä¸å»ºè®®åœ¨æ›´é«˜å±‚ä¸­ä½¿ç”¨
- ä¸ºæœåŠ¡å±‚æä¾›å¯é€‰çš„ä¾èµ–æ³¨å…¥ï¼ˆDIï¼‰
- ä½¿å…¶æ›´åŠ åŸå­åŒ–å’Œæ¨¡å—åŒ–ä»¥å°è£…ä¸šåŠ¡é€»è¾‘
- `å·¥å…·å‡½æ•°`ï¼ˆutilsï¼‰å’Œ `å¸®åŠ©å‡½æ•°`ï¼ˆhelperï¼‰å¯ä»¥ä½œä¸ºç®¡ç†å™¨çš„å­ç±»åˆ«æ”¾åœ¨è¿™é‡Œ

### æ•°æ®æŒä¹…å±‚

- ä¸ºæ‚¨çš„ä¸šåŠ¡ç‰¹æ€§ç²¾ç¡®é€‰æ‹© SQL æˆ– NoSQL æ•°æ®åº“ç±»å‹ï¼Œä¸è¦å¿˜è®°ä¸ºæ•°æ®æ·»åŠ å†—ä½™å’Œå¤‡ä»½ã€‚
- é€‰æ‹© ORM æˆ–å…¶ä»–æ•°æ®åº“æœåŠ¡ä¾›åº”å•†æ¥å¤„ç†æ•°æ®æŒä¹…æ€§ï¼Œå¦‚ `Prisma` æˆ– `TypeORM`ï¼ŒåŒ…æ‹¬è¿ç§»å’Œæ¶æ„ç®¡ç†ã€‚
- æ€»æ˜¯ä»æ•°æ®æ‰©å±•å’Œæ•°æ®ä¸€è‡´æ€§çš„è§’åº¦å‡ºå‘è®¾è®¡æ•°æ®åº“ï¼Œè€ƒè™‘åˆ†å¸ƒå¼æ•°æ®åº“å’Œåˆ†ç‰‡ç­‰ï¼Œåœ¨æ‚¨çœŸæ­£éœ€è¦æ—¶ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„æ•°æ®è®°å½•åœ¨ 3 å¹´å†…è¶…è¿‡ 100 ä¸‡ã€1000 ä¸‡æˆ– 1 äº¿ç­‰ï¼Œåº”è¯¥è®¡åˆ’ä½¿ç”¨ä¸åŒç±»å‹çš„æ•°æ®åº“æŠ€æœ¯ï¼Œå¹¶ä»¥ä¸åŒçš„æ–¹å¼è®¾è®¡æ•°æ®æ¨¡å‹å’Œæ•°æ®ç»“æ„ã€‚
  - è€ƒè™‘ä½¿ç”¨ `Serverless` æ•°æ®åº“æ¥å¤„ç†æ•°æ®æ‰©å±•å’Œç®¡ç†ï¼Œä¾‹å¦‚ `PlantScale`
- åœ¨æ•°æ®åº“ä¸­ä»”ç»†è®¾è®¡æ•°æ®æ¨¡å‹å’Œæ•°æ®ç»“æ„ï¼Œå……åˆ†åˆ©ç”¨æ•°æ®åº“ç´¢å¼•å’ŒæŸ¥è¯¢ä¼˜åŒ–ï¼Œä½†ä¸è¦è¿‡åº¦ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢ã€‚
- éµå¾ªç¤¾åŒºçš„ SQLã€åˆ›å»ºè¡¨ã€åˆ›å»ºç´¢å¼•ã€æŸ¥è¯¢ä¼˜åŒ–ç­‰æœ€ä½³å®è·µæŒ‡å—ã€‚-> ä¾‹å¦‚ï¼Œé˜¿é‡Œå·´å·´çš„ Java å¼€å‘è€…æŒ‡å—ä¸º MySQL å’Œæ•°æ®åº“æä¾›äº†ä¸€äº›æœ€ä½³å®è·µæŒ‡å—ã€‚
- ä½¿ç”¨ _äº‹åŠ¡_ï¼ˆtransactionï¼‰å’Œ _éš”ç¦»_ï¼ˆisolationï¼‰æ¥å¤„ç†æ•æ„Ÿæ•°æ®å’Œæ“ä½œçš„æ•°æ®ä¸€è‡´æ€§å’Œå®Œæ•´æ€§
- ä½¿ç”¨ _åˆ†ç‰‡_ï¼ˆshardingï¼‰å’Œ _åˆ†åŒº_ï¼ˆpartitionï¼‰æ¥å¤„ç†æ•°æ®æ‰©å±•å’Œæ€§èƒ½
- ä½¿ç”¨ _å¤åˆ¶_ï¼ˆreplicationï¼‰å’Œ _å¤‡ä»½_ï¼ˆbackupï¼‰æ¥å¤„ç†æ•°æ®å†—ä½™å’Œå¤‡ä»½

### Next.js æœ€ä½³å®è·µæŒ‡å—

- ä½¿ç”¨ **turbo-pack** + **git-submodules** + **npm packages** æ¥å¤„ç†ä¸åŒçº§åˆ«çš„ä»£ç å…±äº«ä»¥åŠå•ä½“ä»“åº“ï¼ˆmonorepoï¼‰å’Œå¤šä»“åº“ï¼ˆmulti-repoï¼‰
- å……åˆ†åˆ©ç”¨ Next.js åœ¨é¡µé¢/è·¯ç”±ä¸­çš„**åˆ†å±‚ç¼“å­˜ç³»ç»Ÿ**ï¼Œ`React.cache`ï¼Œè·å–ç¼“å­˜ï¼Œå®¢æˆ·ç«¯ç¼“å­˜ï¼Œå¤–éƒ¨ redis-cache ç­‰ã€‚
  - âœ¨ [Next.js ç¼“å­˜ç³»ç»Ÿ](https://nextjs.org/docs/app/building-your-application/caching) - ä»”ç»†é˜…è¯»å¹¶æ˜æ™ºåœ°ä½¿ç”¨å®ƒ ğŸ˜

![layered-cache-of-nextjs](https://nextjs.org/_next/image?url=https%3A%2F%2Fh8DxKfmAPhn8O0p3.public.blob.vercel-storage.com%2Fdocs%2Fdark%2Fcaching-overview.png&w=3840&q=75)

- å°è¯•ä½¿ç”¨ _EdgeRuntime_ æ¥å¤„ç†é™æ€å†…å®¹å’Œç›¸å…³ç®€å•ä»»åŠ¡çš„è·å–
- next.js 15 ä¸­é—´ä»¶å¯ä»¥åŒæ—¶åœ¨è¾¹ç¼˜è¿è¡Œæ—¶å’ŒèŠ‚ç‚¹è¿è¡Œæ—¶ä¸­è¿è¡Œï¼Œåœ¨ `middleware` ä¸­å¤„ç†å¸¸è§çš„è¯·æ±‚é€»è¾‘ï¼Œå¹¶ä½¿ç”¨ `next/server` å¤„ç†è¯·æ±‚å’Œå“åº”
- å¯¹äºé«˜æ€§èƒ½è®¡ç®—ä»»åŠ¡ï¼Œä½¿ç”¨ Rust + WASMï¼Œä¾‹å¦‚é€šè¿‡ _tiktoken_ è®¡ç®—å¤§æ•°æ®çš„ä»¤ç‰Œ
- åˆ†ç¦» ServerComponentData / ClientComponentDataï¼Œå·§å¦™åœ°å¤„ç†æœåŠ¡å™¨ç«¯æ¸²æŸ“å’Œå®¢æˆ·ç«¯æ¸²æŸ“
- ä½¿ç”¨åº“çš„å†…éƒ¨å®ç°åŸºæœ¬ç»„ä»¶ï¼š
  - ä½¿ç”¨ CDN ä¸ºé™æ€æ–‡ä»¶å’Œå†…å®¹æä¾›æœåŠ¡ï¼Œä½¿ç”¨ `next/image` ç­‰è¿›è¡Œèµ„æºä¼˜åŒ–
  - ä½¿ç”¨ `next/script` è¿›è¡Œè„šæœ¬ä¼˜åŒ–
- åˆ©ç”¨ next.js é¡µé¢å†…åµŒçš„ `metadata` èƒ½åŠ›æå‡ SEO å’Œ SNS åˆ†äº«
- é€šè¿‡ Next.js çš„ `dynamic/import` ä¸ `Suspense` å’Œ `React.lazy` æœºåˆ¶æå‡æ€§èƒ½
- ä½¿ç”¨ `server` / `client` / `shared` æ–‡ä»¶å¤¹æ¥åˆ†éš”ä¸åŒè¿è¡Œæ—¶çš„ä»£ç 
- åœ¨è¿›å…¥ç”Ÿäº§ç¯å¢ƒå‰ï¼Œæ£€æŸ¥ `next.config.js` ä¸­çš„æ¯ä¸€ä¸ªå¯èƒ½çš„é…ç½®ï¼Œä»¥ä¼˜åŒ–æ€§èƒ½å’Œå®‰å…¨æ€§
- **ä½¿ç”¨ `sever-action`** æ¥é¿å…é‡å¤çš„ API è·¯ç”±å£°æ˜ï¼Œå¹¶æ— ç¼å¤„ç†æœåŠ¡å™¨ç«¯é€»è¾‘å’Œå®¢æˆ·ç«¯é€»è¾‘

> ä¼˜å…ˆä½¿ç”¨ Server Actions :)

### å……åˆ†åˆ©ç”¨ Node / JavaScript ç”Ÿæ€ç³»ç»Ÿä¸­çš„å·¥å…·/åº“

> é¿å…é‡å¤é€ è½®å­ï¼Œä½¿ç”¨ Node / JavaScript ç”Ÿæ€ç³»ç»Ÿä¸­æœ€å¥½çš„å·¥å…·å’Œåº“ã€‚
>
> è¿‘å¹´æ¥ï¼Œ`Supabase` æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ä¾‹å­ï¼Œå®ƒåˆ©ç”¨ Node / JavaScript ç”Ÿæ€ç³»ç»Ÿä¸­æœ€å¥½çš„å·¥å…·å’Œåº“æ¥æ„å»ºå…¨æ ˆåº”ç”¨ã€‚

- Vercel çš„ `ai` SDK æ˜¯å¤„ç† AI ç›¸å…³ä»»åŠ¡ï¼ˆllm, ä»£ç†åº”ç”¨åˆ›å»ºè€…ç­‰ï¼‰çš„ç»ä½³æ–¹å¼
- æ•°æ®åº“å±‚å¯ä»¥ä½¿ç”¨ `Prisma` ORM æˆ–å…¶ä»–æ•°æ®åº“æœåŠ¡ä¾›åº”å•†
- ä½¿ç”¨ `Jest` æˆ–å…¶ä»–æµ‹è¯•æœåŠ¡æ¥å¤„ç†å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
- ä½¿ç”¨è·Ÿè¸ª API å’Œå·¥å…·è¿›è¡Œé”™è¯¯/è¯·æ±‚è¿½è¸ªï¼Œä¾‹å¦‚ `Sentry` / `Raygun`
- ä½¿ç”¨æ—¥å¿— API å’Œå·¥å…·ï¼ŒåŒ…æ‹¬ SLS / ELK è¿›è¡Œæ—¥å¿—è®°å½•å’Œè°ƒè¯•
- è€ƒè™‘ä½¿ç”¨ `GlobalRef` ç”¨äºé•¿æ—¶é—´å­˜åœ¨çš„ node è¿è¡Œæ—¶ï¼Œè€Œä¸æ˜¯æ— æœåŠ¡å™¨è¿è¡Œæ—¶ï¼ˆserverless runtimeï¼‰
- æ·»åŠ å•å…ƒæµ‹è¯•ä»¥è¦†ç›–åŸºæœ¬çš„åº“/å·¥å…·å’Œå…³é”®çš„ä¸šåŠ¡é€»è¾‘
- ä½¿ç”¨é…ç½®ä¸­é—´ä»¶å¦‚ `Diamond`ï¼ˆé˜¿é‡Œå·´å·´çš„é…ç½®ä¸­é—´ä»¶ï¼‰æˆ– Vercel `Configs` æ¥ç®¡ç†åº”ç”¨é…ç½®
- ä½¿ç”¨ `Redis` æˆ–å…¶ä»–å†…å­˜å…±äº«å·¥å…·æ¥å¤„ç†ä¸åŒæœåŠ¡å™¨å®ä¾‹é—´çš„ç¼“å­˜å’Œä¼šè¯å…±äº«
- è€ƒè™‘ä½¿ç”¨ AB æµ‹è¯•æœåŠ¡æˆ–ç°åº¦å‘å¸ƒæœåŠ¡æ¥å¤„ç†åŠŸèƒ½å‘å¸ƒ
- ä½¿ç”¨ `Kafka` æˆ–å…¶ä»–æ¶ˆæ¯é˜Ÿåˆ—æ¥å¤„ç†å¼‚æ­¥ä»»åŠ¡å’Œäº‹ä»¶é©±åŠ¨çš„ä»»åŠ¡
- ä½¿ç”¨ `K8S` æˆ–å…¶ä»–å®¹å™¨æœåŠ¡æ¥å¤„ç†éƒ¨ç½²å’Œæ‰©å±•
- ä½¿ç”¨ `Prometheus` æˆ–å…¶ä»–ç›‘æ§æœåŠ¡æ¥å¤„ç†ç›‘æ§å’ŒæŠ¥è­¦
- ä½¿ç”¨ `Grafana` æˆ–å…¶ä»–ä»ªè¡¨æ¿æœåŠ¡æ¥å¤„ç†ä»ªè¡¨æ¿å’Œå¯è§†åŒ–
- ä½¿ç”¨ `Jenkins` æˆ–å…¶ä»– CI/CD æœåŠ¡ï¼ˆå¦‚ Github Actions æˆ– Vercelï¼‰æ¥å¤„ç† CI/CD æµæ°´çº¿å’Œç”Ÿäº§è¿‡ç¨‹
- ...

### åº“å’Œç›®å½•ç»“æ„æŒ‡å—

æ¨èçš„ Next.js å…¨æ ˆåº”ç”¨ç›®å½•ç»“æ„ï¼š

```bash
.
â”œâ”€â”€ app
â”œâ”€â”€ components
â”œâ”€â”€ configs
â”œâ”€â”€ data
â”œâ”€â”€ tools
â”œâ”€â”€ i18n
â”œâ”€â”€ lib
â”œâ”€â”€ prisma
â”œâ”€â”€ public
â”œâ”€â”€ services
â”œâ”€â”€ tailwind.config.ts
â”œâ”€â”€ tsconfig.json
â””â”€â”€ types
```

ç›®å½•ç»“æ„çš„ä¾èµ–å…³ç³»ï¼š

- åŸºç¡€åŠŸèƒ½
  - `public`: å…¬å…±é™æ€æ–‡ä»¶
  - `prisma`: prisma æ•°æ®åº“æ¶æ„å’Œæ¨¡å‹
  - ...
- å…¨å±€å…±äº«
  - `tools`: åº”ç”¨çš„å…¨å±€å·¥å…·ï¼ˆè„šæœ¬ä¹ŸåŒ…å«åœ¨è¿™é‡Œï¼‰
  - `types`: ç”¨äºå¤–éƒ¨åº“æˆ–ä½çº§åˆ«é€šç”¨å…±äº«ç±»å‹çš„å…¨å±€ç±»å‹
  - `configs`: åº”ç”¨çš„å…¨å±€é…ç½®
  - `i18n`: åº”ç”¨çš„å…¨å±€å›½é™…åŒ–é…ç½®
- å…±äº«é€»è¾‘
  - `lib`: å…±äº«åº“å’Œå·¥å…·ï¼Œæ˜¯ä¸Šå±‚å…±äº«çš„åŸºæœ¬æ„å»ºå—ï¼Œå¦‚ `utils`ã€`helpers`ã€`constants`ã€`bizTypes`ã€`manager` ç­‰
  - `services`: å…±äº«æœåŠ¡
  - `components`: å…±äº«ç»„ä»¶
- åº”ç”¨é€»è¾‘
  - `app`: next.js åº”ç”¨çš„ä¸»å…¥å£

æ›´å¤šç»†èŠ‚ï¼š

```markdown
- `app`: next.js åº”ç”¨çš„ä¸»å…¥å£
  - `[bizRoute]`: ä¸šåŠ¡é¡µé¢è·¯ç”±
    - `page.tsx`: ä¸šåŠ¡é¡µé¢
    - å…¶å®ƒ Next.js è§„å®šçš„æ–‡ä»¶
    - `*.server.tsx`: æœåŠ¡å™¨ä¸šåŠ¡ç»„ä»¶
    - `*.client.tsx`: å®¢æˆ·ç«¯ä¸šåŠ¡ç»„ä»¶
  - `api`: api è·¯ç”±
    - `/v1`: ä¾›å…¬ä¼—ä½¿ç”¨çš„ç‰ˆæœ¬åŒ– api è·¯ç”±
      - `*.ts`: api è·¯ç”±
- `components`: å…±äº«ç»„ä»¶
  - `server`: æœåŠ¡å™¨ç«¯ç»„ä»¶
  - `client`: å®¢æˆ·ç«¯ç»„ä»¶
  - `shared`: å…±äº«ç»„ä»¶
- `configs`: åº”ç”¨å…±äº«é…ç½®
- `lib`: å…±äº«åº“å’Œå·¥å…·
  - `server`: æœåŠ¡å™¨ç«¯åº“å’Œå·¥å…·
  - `client`: å®¢æˆ·ç«¯åº“å’Œå·¥å…·
  - `shared`: å…±äº«åº“å’Œå·¥å…·
    - `*.manager.ts`: å¯å…±äº«çš„ä¸šåŠ¡ç®¡ç†å™¨
- `services`: å…±äº«æœåŠ¡
  - `server`: æœåŠ¡å™¨ç«¯æœåŠ¡
  - `client`: å®¢æˆ·ç«¯æœåŠ¡
  - `shared`: å…±äº«æœåŠ¡
    - `*.service.ts`: å¯å…±äº«çš„ä¸šåŠ¡æœåŠ¡
- `public`: å…¬å…±é™æ€æ–‡ä»¶
```

æˆ–è€…ï¼Œä¸ºäº†ç»Ÿä¸€çš„ä¸šåŠ¡é€»è¾‘æ¨¡å—ï¼Œæ‚¨å¯ä»¥å°†æ–‡ä»¶åˆ†ç»„åˆ°ä¸€ä¸ªæ¨¡å—æ–‡ä»¶å¤¹ä¸­ï¼Œä»¥ä½¿å…¶æ›´æ¸…æ™°å’Œæ˜“äºç»´æŠ¤ï¼š

```markdown
- `module-name`
  - `*.client.ts(x)`
  - `*.server.ts(x)`
  - `*.shared.ts(x)`
```

å®Œæ•´ç¤ºä¾‹å¯ä»¥æ˜¯ï¼š

```bash
â”œâ”€â”€ elaborator
â”‚   â”œâ”€â”€ client
â”‚   â”‚   â”œâ”€â”€ flow.manager.ts
â”‚   â”‚   â””â”€â”€ position.manager.tsx
â”‚   â”œâ”€â”€ server
â”‚   â”‚   â””â”€â”€ elaborator.base.task.ts
â”‚   â”œâ”€â”€ shared
â”‚   â”‚   â”œâ”€â”€ elaborator.diagram.manager.ts
â”‚   â”‚   â”œâ”€â”€ elaborator.enum.ts
â”‚   â”‚   â””â”€â”€ elaborator.type.ts
â”‚   â””â”€â”€ tasks
â”‚       â”œâ”€â”€ edoc-generator
â”‚       â”‚   â””â”€â”€ doc-generator.server.ts
â”‚       â”œâ”€â”€ mental-framework-generator
â”‚       â”‚   â””â”€â”€ mental-framework-generator.server.ts
â”‚       â””â”€â”€ problem-outline-generator
â”‚           â”œâ”€â”€ problem-outline-generator.server.ts
â”‚           â””â”€â”€ problem-outline.node.client.tsx
```

- æ§åˆ¶æ–‡ä»¶åçš„é•¿åº¦ï¼Œä½¿ç”¨`è·¯å¾„`ä½œä¸ºä¸Šä¸‹æ–‡ï¼Œä¸è¦è®©æ–‡ä»¶åå¤ªé•¿

æˆ‘çš„å®è·µï¼š

- [ğŸŒŸ Github - arno packages](https://github.com/SurfaceW/arno-packages)ï¼šéµå¾ªä¸Šè¿°åŸåˆ™çš„æˆ‘çš„åŸºç¡€åŒ…ã€‚

## Web å®¢æˆ·ç«¯

### React æœ€ä½³å®è·µæŒ‡å—

Arno ä»¥å‰æ€»ç»“è¿‡ React æœ€ä½³å®è·µæŒ‡å— ğŸ‘‡ğŸ»

- [Arno çš„ React æœ€ä½³å®è·µæŒ‡å—](/posts/en/react-bp)
- [Arno çš„ React çŠ¶æ€ç®¡ç†æœ€ä½³å®è·µ](/posts/en/react-state-management)

---

- å°†**é€»è¾‘**å’Œ**è§†å›¾**åˆ†ç¦»åœ¨ä¸åŒå±‚æ¬¡
  - JSX / ç»„ä»¶åº”å½“çº¯ç²¹ä½¿ç”¨å‡½æ•°å¼æ–¹å¼
  - ä¸è¦åœ¨ JSX / ç»„ä»¶ä¸­ç¼–å†™å¤§æ®µçš„ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚å¤„ç†ç¨‹åºï¼ˆhandlerï¼‰/ å›è°ƒï¼ˆcallbacksï¼‰/ é’©å­ï¼ˆhooksï¼‰ï¼Œåº”ä½¿ç”¨å®¢æˆ·ç«¯ç®¡ç†å™¨æˆ–æœåŠ¡ä¸­çš„å‡½æ•°
  - å°½å¯èƒ½å°è¯•ä½¿ç”¨ _Server Actions_ ä»¥æ›´ç®€å•æ˜äº†çš„æ–¹å¼åŒæ—¶å¤„ç†æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯çš„é€»è¾‘
- å°†å®¢æˆ·ç«¯çš„`çŠ¶æ€ï¼ˆStateï¼‰`åˆ†ç¦»åœ¨ä¸åŒå±‚æ¬¡
  - `ServerState`ï¼šç”±æœåŠ¡å™¨ç®¡ç†çš„çŠ¶æ€
    - ä½¿ç”¨é’©å­æ¥ä½œä¸ºæœåŠ¡å™¨çš„çŠ¶æ€ï¼Œæ¯”å¦‚ä½ç½® / url è·¯å¾„å / æœç´¢å‚æ•° / next å‚æ•°ç­‰...
    - ä½¿ç”¨ `SWR` æˆ– `ReactQuery` æ¥å¤„ç†æœåŠ¡å™¨çŠ¶æ€å’Œç¼“å­˜ï¼Œæˆ–è€…ç›´æ¥åœ¨æœåŠ¡å™¨ç»„ä»¶çš„é¡µé¢ä¸­å¤„ç†ï¼Œä»¥å‡å°‘å®¢æˆ·ç«¯çš„å¤æ‚æ€§
  - `SharedContext` é€šå¸¸ä¸ä¼šé¢‘ç¹å˜åŠ¨ï¼Œä½¿ç”¨ `React.Context` æ¥å¤„ç†å…±äº«çŠ¶æ€å’Œä¸Šä¸‹æ–‡ï¼Œä¾‹å¦‚ä¸»é¢˜ï¼ˆThemeï¼‰ã€åœ°åŒºè®¾ç½®ï¼ˆLocaleï¼‰ã€ç”¨æˆ·ï¼ˆUserï¼‰ç­‰ä½œä¸ºå…¨å±€å…±äº«ä¸Šä¸‹æ–‡ã€‚
  - `SharedState` ä½¿ç”¨ `redux`ã€`zustand` æˆ– `recoil` ä»¥åŠæ—¥å¿—è®°å½•å™¨å’Œä¸­é—´ä»¶æ¥æ›´å¥½åœ°å¤„ç†ç»„ä»¶ä¹‹é—´å…±äº«çš„ä¸å¯å˜çŠ¶æ€ï¼Œè¿™æ ·çš„çŠ¶æ€å¯ä»¥è½»æ¾åœ°è¿›è¡Œå¯è§†åŒ–ã€è¿½è¸ªã€è®°å½•å’Œè°ƒè¯•ã€‚
  - `ReactiveState` è€ƒè™‘ä½¿ç”¨ `RxJS` æˆ– `Mobx` æ¥å¤„ç†ååº”æ€§çŠ¶æ€å’Œäº‹ä»¶é©±åŠ¨çš„çŠ¶æ€
  - `LocalComponentState` å°è¯•ä½¿ç”¨ `useState` å’Œ `useReducer` æ¥å¤„ç†ç»„ä»¶çš„æœ¬åœ°çŠ¶æ€
- **é¦–å…ˆè€ƒè™‘é’©å­é£æ ¼ï¼ˆHook-Style Firstï¼‰**æ¥å°è£…é€»è¾‘ï¼Œä½¿å…¶åœ¨ç»„ä»¶ä¹‹é—´æ›´åŠ å¯å¤ç”¨ï¼Œå‡å°‘ JSX ç»„ä»¶ä¸»ä½“ä¸­çš„ä»£ç ï¼Œä½¿ä»£ç æ›´æ¸…æ™°æ˜“ç»´æŠ¤

### é€»è¾‘å°è£…

- **æœåŠ¡ï¼ˆServiceï¼‰** ç±»ä¼¼äºæœåŠ¡å™¨æœåŠ¡ã€å®¢æˆ·ç«¯æœåŠ¡ä»¥åŠå°è£…çš„ apiï¼Œå¯é€šè¿‡ `useSwr` æˆ– `useQuery` æˆ–å…¶ä»– API å®¢æˆ·ç«¯è°ƒç”¨ã€‚
  - ä¸€äº›å…¸å‹çš„ä¾‹å­åŒ…æ‹¬ï¼š
    - æœ¬åœ°çš„æ•°æ®åº“æœåŠ¡
    - æœ¬åœ°æ•°æ®ç¼“å­˜æœåŠ¡
    - Restful API æœåŠ¡
  - æœåŠ¡å¯ä»¥å°è£…é€»è¾‘å¹¶ä¼˜é›…åœ°å¤„ç†é”™è¯¯å’Œå“åº”ï¼Œä¸åº”è¯¥æŠ›å‡ºå¼‚å¸¸æˆ–é”™è¯¯
  - æœåŠ¡å¯ä»¥åè°ƒä¸åŒçš„æœåŠ¡æˆ–ç®¡ç†å™¨æ¥å¤„ç†å¤æ‚çš„é€»è¾‘
  - ...
- **ç®¡ç†å™¨ï¼ˆManagerï¼‰** ç±»ä¼¼äºæœåŠ¡å™¨ç®¡ç†å™¨ã€å®¢æˆ·ç«¯ç®¡ç†å™¨ä»¥åŠå°è£…çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¯ç”±æœåŠ¡æˆ–ç»„ä»¶è°ƒç”¨
  - ä¸€äº›å…¸å‹çš„ä¾‹å­åŒ…æ‹¬ï¼š
    - ä¸šåŠ¡é€»è¾‘ç®¡ç†å™¨
    - æ—¥å¿—ç®¡ç†å™¨
    - äº‹ä»¶å‘å¸ƒ/è®¢é˜…ç®¡ç†å™¨
    - ...
  - ç®¡ç†å™¨æ˜¯ä¸šåŠ¡é€»è¾‘çš„åŸºæœ¬æ„å»ºå—ï¼Œå¯ä»¥è¢«ä¸åŒçš„æœåŠ¡é‡ç”¨
  - ç®¡ç†å™¨å¯ä»¥æŠ›å‡ºé”™è¯¯ï¼Œæ— éœ€é¢å¤–å¤„ç†ï¼Œåº”ç”±æœåŠ¡é€‚å½“å¤„ç†

### æ€§èƒ½å’Œå­˜å‚¨çš„æç¤º

- ä½¿ç”¨ web worker æ¥å¤„ç†ç¹é‡çš„è®¡ç®—ä»»åŠ¡
- ä½¿ç”¨ _Rust_ / _WASM_ æ¥å¤„ç†ç¹é‡çš„è®¡ç®—ä»»åŠ¡
- ä½¿ç”¨ Service Worker æ¥å¤„ç†ç¦»çº¿å’Œç¼“å­˜æ•°æ®åŠè¯·æ±‚
- ä½¿ç”¨æœ¬åœ°æ•°æ®åº“å¦‚ `IndexedDB` æ¥å¤„ç†æœ¬åœ°å­˜å‚¨å’Œç¼“å­˜
- ä½¿ç”¨ `localStorage` / `sessionStorage` æ¥å¤„ç†ç”¨æˆ·åå¥½å’Œä¸´æ—¶æ•°æ®ç¼“å­˜çš„æœ¬åœ°å­˜å‚¨å’Œç¼“å­˜

### ç½‘ç»œå’Œé€šä¿¡

- ä½¿ç”¨ WebRTC / Websocket è¿›è¡Œæ›´å®æ—¶å’Œäº¤äº’å¼çš„ä»»åŠ¡
- é¦–å…ˆä½¿ç”¨åŸç”Ÿ `fetch` API è€Œä¸æ˜¯ ajax æˆ–å…¶ä»–ç½‘ç»œé€šä¿¡æœºåˆ¶
- ä½¿ç”¨ Fetch API ç»“åˆ WebStream æ¥å¤„ç†å¤§æ•°æ®ä¼ è¾“å’Œæµæ•°æ®

### UI & UX æç¤º

- ä½¿ç”¨ `TailwindCSS` æˆ– `ChakraUI` æ¥å¤„ç†ç”¨æˆ·ç•Œé¢å’Œå¸ƒå±€
- ä½¿ç”¨ `AntD` æˆ– `MaterialUI`ï¼Œå®ƒä»¬å…·æœ‰é«˜åº¦*å¯å®šåˆ¶çš„ä¸»é¢˜*ï¼Œå¹¶å°è£…äº†*å¤æ‚çš„é€»è¾‘å’ŒåŠŸèƒ½*
- ä½¿ç”¨ `Storybook` æˆ–å…¶ä»– UI æµ‹è¯•æœåŠ¡æ¥å¤„ç†ç”¨æˆ·ç•Œé¢æµ‹è¯•å’Œè§†è§‰æµ‹è¯•
- è€ƒè™‘åœ¨ä¸åŒçš„è§†å£ã€å°ºå¯¸ã€ç‰ˆæœ¬ç­‰æ–¹é¢çš„*å…¼å®¹æ€§*
- éµå¾ªç§»åŠ¨ Web åº”ç”¨å¼€å‘åŸåˆ™çš„æœ€ä½³å®è·µï¼ˆBPï¼‰
- éµå¾ªå¹¶åº”ç”¨ Google / Apple / Microsoft / Mozilla / W3C ç­‰çš„ä¸€äº› web å¼€å‘æŒ‡å—
- è€ƒè™‘éµå®ˆæ— éšœç¢æ€§ï¼ˆA11Yï¼‰å’Œå›½é™…åŒ–ï¼ˆI18Nï¼‰åŸåˆ™
- æ·»åŠ ä¸€äº›åˆç†çš„åŠ¨ç”»å’Œè¿‡æ¸¡æ•ˆæœï¼Œä½¿ UI æ›´ç”ŸåŠ¨å’Œäº’åŠ¨
- å“åº”å¼è®¾è®¡ä¼˜å…ˆ
- æš—è‰²æ–¹æ¡ˆå…¼å®¹æ€§
- ä½¿ç”¨ `SSG` / `SSR` / `ISR` / `CSR` / `Reactive` / `Hybrid` æ¥å¤„ç†ä¸åŒçš„æ¸²æŸ“ç­–ç•¥ï¼Œä»¥æå‡æ€§èƒ½å’Œç”¨æˆ·ä½“éªŒ
- ...

### ç‰¹å®šé¢†åŸŸçš„æŠ€æœ¯

ä¸è¦é‡å¤é€ è½®å­ï¼Œä½¿ç”¨ç‰¹å®šé¢†åŸŸçš„æŠ€æœ¯æ¥å¤„ç†ç‰¹å®šä»»åŠ¡ã€‚

- æ–‡æœ¬ç¼–è¾‘å™¨ / é›†æˆå¼€å‘ç¯å¢ƒï¼ˆIDEï¼‰/ ä»£ç æ ¼å¼åŒ–å™¨ï¼ˆCode Formatterï¼‰/ ä»£ç æ£€æŸ¥å·¥å…·ï¼ˆLinterï¼‰...
- å›¾è¡¨ / å›¾å½¢ / æ•°æ®å¯è§†åŒ–...
- åœ°å›¾ / å®šä½ / åœ°ç†ä¿¡æ¯...
- å®æ—¶åä½œ...
- 3D æ¸²æŸ“ / 2D æ¸²æŸ“ / åŠ¨ç”»...
- éŸ³é¢‘ / è§†é¢‘ / åª’ä½“...
- Web XR / VR / AR...
- ...

### åŸç”Ÿå®¢æˆ·ç«¯

- å¯ä»¥ç­‰å¾…ä¸ºåŸç”Ÿå®¢æˆ·ç«¯æä¾›æœ€ä½³å®è·µï¼ˆBPï¼‰ï¼Œä¾‹å¦‚ iOS / Android / Windows / Mac / Linux / WebOS / Tizen / HarmonyOS / ... çš„æ“ä½œã€‚

Arno ä»åœ¨æ¢ç´¢ ğŸ§­

## å¸¸è§æ¨¡å¼å’Œçº¦å®š

ä¸º next.js å…¨æ ˆåº”ç”¨å¼€å‘æä¾›å¼€å‘è€…å¯ä»¥éµå¾ªå’Œä½¿ç”¨çš„ä¸€äº›å¸¸è§æ¨¡å¼å’Œçº¦å®šã€‚

### é”™è¯¯å¤„ç†æ¨¡å¼ (Error Handling Patterns)

> 0 é”™è¯¯å¤„ç†æ˜¯æœ€ä½³çš„é”™è¯¯å¤„ç†ï¼Œä½†åœ¨ç°å®ä¸–ç•Œä¸­æˆ‘ä»¬æ— æ³•é¿å…é”™è¯¯ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ä¼˜é›…ä¸”æ°å½“åœ°å¤„ç†é”™è¯¯ã€‚
>
> - ä½çº§åˆ«çš„ API åº”è¯¥å‡å°‘æŠ›å‡ºé”™è¯¯ï¼Œå¹¶åœ¨é«˜çº§åˆ«çš„ API ä¸­å¤„ç†é”™è¯¯
> - ä½¿ç”¨ä¸€ä¸ªåœ°æ–¹å¤„ç†å’Œè®°å½•é”™è¯¯ï¼Œä¸è¦åœ¨ä¸åŒåœ°æ–¹ç”¨é‡å¤çš„ä»£ç å¤„ç†é”™è¯¯

- åœ¨`æœåŠ¡å™¨`(Server)å’Œ`å®¢æˆ·ç«¯`(Client)ä¸­éƒ½ä½¿ç”¨åŸç”Ÿçš„`Error`å¯¹è±¡ï¼Œå¹¶ä¸”ä¸è¦æ‰©å±•å®ƒä»¥å¢åŠ å¤æ‚æ€§ï¼Œä½¿ç”¨ç»Ÿä¸€çš„é”™è¯¯ä¿¡æ¯æ ¼å¼ï¼Œå¦‚ï¼š

```log
[2024-03-12 12:00:00] [ERROR level] [ServiceName] [ErrorTypeCode] [ErrorMsg]
[?ErrorStack] å¦‚æœ‰å¿…è¦
```

- å¯¹äºå¸¸è§çš„ HTTP åè®®çš„æœåŠ¡å™¨å“åº”ï¼Œé”™è¯¯åº”è¯¥å……åˆ†åˆ©ç”¨ HTTP çŠ¶æ€ç ã€æ¶ˆæ¯æ¥æè¿°å“åº”ä¸­çš„é”™è¯¯ï¼Œå…¶ä»– RPC åè®®åº”è¯¥éµå¾ªå®ƒä»¬è‡ªå·±çš„é”™è¯¯å¤„ç†æ ¼å¼æ¨¡å¼
- ä½¿ç”¨`warn` / `error` å’Œ `fatal`æ¥å¤„ç†ä¸åŒçº§åˆ«çš„é”™è¯¯ï¼Œå¯¹äºä¸¥é‡çº§åˆ«çš„é”™è¯¯å’Œè‡´å‘½é”™è¯¯ï¼Œæˆ‘ä»¬åº”è¯¥ä½¿ç”¨`æ—¥å¿—`(log)æœåŠ¡æ¥æŠ¥å‘Šï¼Œä»¥ä¿è¯ç¨³å®šæ€§å’Œå¯é æ€§
- åœ¨æœåŠ¡/ç®¡ç†å±‚ä½¿ç”¨`try` / `catch`æ¥å¤„ç†é”™è¯¯ï¼Œå¹¶ä¸” try-catch è¯­å¥å—çš„èŒƒå›´åº”è¯¥å°½å¯èƒ½å°ï¼Œä»¥é¿å…æ€§èƒ½é—®é¢˜å’Œä»£ç çš„æ¨¡ç³Šæ€§
- åœ¨ç»„ä»¶çš„å®¢æˆ·ç«¯å±‚ä½¿ç”¨`ErrorBoundary`æ¥å¤„ç†é”™è¯¯ï¼Œç”¨äºæ˜¾ç¤º`å¤‡ç”¨`(fallback)ä¿¡æ¯å’Œæ¥è‡ªå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„é”™è¯¯ä¿¡æ¯
  - æ¯”å¦‚ï¼š[`error-boundary.tsx`](https://github.com/SurfaceW/arno-packages/blob/main/ui/client/error-boundary/index.tsx) ç”¨äºå®ç°ç»Ÿä¸€çš„ UI é”™è¯¯å¤„ç†

### æ–‡ä»¶ç±»å‹å’Œçº¦å®š

- `*.type.ts`ï¼šå¯ä»¥å…±äº«çš„ TypeScript è¯­è¨€ç±»å‹
- `*.constant.ts`ï¼šå¯ä»¥å…±äº«çš„å¸¸é‡
- `*.util.ts`ï¼šå¯ä»¥å…±äº«çš„å®ç”¨å·¥å…·å‡½æ•°
- `*.manager.ts`ï¼šå¯ä»¥å…±äº«çš„ä¸šåŠ¡ç®¡ç†å™¨
- `*.manager.impl.ts`ï¼šæŠ½è±¡ç®¡ç†å™¨çš„å®ç°
- `*.service.ts`ï¼šå¯ä»¥å…±äº«çš„ä¸šåŠ¡æœåŠ¡
- `*.service.impl.ts`ï¼šæŠ½è±¡æœåŠ¡çš„å®ç°
- `*.store.ts`ï¼šå¯ä»¥å…±äº«çš„ zustand æˆ–ä»»ä½•å…¶ä»– React çŠ¶æ€ç®¡ç†å•å…ƒçš„ä¸šåŠ¡å­˜å‚¨
- `*.hook.ts`ï¼šå¯ä»¥å…±äº«çš„ä¸šåŠ¡é’©å­ï¼ˆHookï¼‰
- `*.client.tsx`: å®¢æˆ·ç«¯å…±äº«ç»„ä»¶
- `*.server.tsx`: æœåŠ¡å™¨ç«¯å…±äº«ç»„ä»¶
- `*.shared.tsx`: å…±äº«ç»„ä»¶
- `*.server.action.ts`: Next.js çš„ Server Action å¯ä»¥åœ¨æœåŠ¡å™¨å’Œå®¢æˆ·ç«¯ä¹‹é—´å…±äº«
- `*.[designPatternName].*.ts` : æŒ‰ç…§è®¾è®¡æ¨¡å¼çš„å‘½åæ–¹å¼æ¥å‘½åæ–‡ä»¶
  - `account.adapter.impl.ts` ç‰¹å®šæœåŠ¡çš„é€‚é…å™¨æ¨¡å¼å®ç°

### ç±»æ–¹æ³•å‘½åçº¦å®š

- æ–¹æ³•åä½¿ç”¨åŠ¨è¯åœ¨å‰åè¯åœ¨åï¼Œä¾‹å¦‚ `createUser`ã€`getUser`ã€`updateUser`ã€`deleteUser`
- å¯¹äºæœåŠ¡çš„ `CRUD` æ“ä½œï¼Œä½¿ç”¨ `create`ã€`get / list`ã€`update`ã€`delete` ä½œä¸ºæ–¹æ³•åå‰ç¼€
- å¯¹äºå¸¸è§æ“ä½œå¦‚ `search`ã€`fetch`ã€`count`ã€`aggregate` ç­‰ä¹Ÿå¯ä½œä¸ºæ–¹æ³•åå‰ç¼€
- å¯¹äºå¸¸è§çŠ¶æ€è½¬æ¢æ“ä½œå¦‚ `init`ã€`start`ã€`stop`ã€`pause`ã€`resume` ç­‰å¯ä½œä¸ºæ–¹æ³•åå‰ç¼€
- ä½¿ç”¨ `batch`ã€`bulk`ã€`multi` ä½œä¸ºæ‰¹é‡æ“ä½œçš„æ–¹æ³•åå‰ç¼€

## å‚è€ƒèµ„æ–™

æˆ‘çš„ç›¸å…³æ–‡ç« ï¼š

- [é«˜æ•ˆå…¨æ ˆå¼€å‘](https://arno.surfacew.com/posts/en/effective-fullstack-dev)
- [AI é©±åŠ¨çš„å‰ç«¯å¼€å‘](https://arno.surfacew.com/posts/en/ai-driven-front-end)

#### å…³äºæœ¬æ–‡çš„æ³¨é‡Š

- 2024-02-02: initial version
- 2024-03-12: bugfix and add more details for some topics, add `db` related topics guide
- 2024-03-29: add directory naming conventions for components
- 2024-10-21: upgrade recent server-action bp and add more details for the recent experience accumulated
- 2025-05-13: keep updated with latest knowledge and version of next.js and other related technologies
